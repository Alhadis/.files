.\" -*- coding: utf-8 -*-
.Dd August 3, 2024
.Dt DSCLEAN 1
.Os "Mac OS X"
.
.Sh NAME
.Nm dsclean
.Nd recursively purge a directory of .DS_Store files
.
.Sh SYNOPSIS
.Nm
.Op Fl pq
.Op Pa directory
.Nm
.Op Fl h | -home
.
.Sh DESCRIPTION
.Nm
recursively cleans
.Ar directory
of .DS_Store files generated by macOS\(cqs Finder.
Modification times are preserved if possible.
.
.Pp
If
.Ar directory
is omitted,
the current working directory is used instead.
.
.\" Options
.Bl -tag -width 4n
.
.It Fl h , -home
Target the user\(cqs home directory instead of
.Ar directory
.Pq if present .
Analogous to
.Ql Nm dsclean No ~ Pf 2> Pa /dev/null .
.
.Pp
.Em Note :
Error messages emitted by
.Xr find 1
will be silenced, as certain user directories are private by default on macOS.
.
.It Fl p
Include partially-matching filenames such as
.Pa Junk.DS_Store .
.
.It Fl q
Suppress all output.
Analogous to
.Ql Nm Pf > Pa /dev/null .
.El
.
.Sh ENVIRONMENT
.ad l
.de NC
.	ie n .Em no-color.org
.	el   .Lk no-color.org
..
.Bl -tag -width FORCE_COLOUR
.It Ev FORCE_COLOR
If set to a non-empty string,
terminal highlighting will be used unconditionally,
even when output is redirected.
This variable takes precedence over
.Ev NO_COLOR ,
and its exact value is immaterial.
Note that
.Nm Ap s
support for the
.Ev FORCE_COLOR
variable is an unofficial extension to the
.NC
specification.
.
.It Ev NO_COLOR
If set to a non-empty string,
terminal highlighting (colours and bold text) are suppressed,
even when output is attached to a TTY.
Consult
.NC
for details of the specification honoured by
.Nm .
.El
.
.Sh EXIT STATUS
.Ex -std
.
.Sh SEE ALSO
.Xr chflags 1 ,
.Xr find 1 ,
.Xr rm 1 ,
.Xr Mac::Finder::DSStore 3
.
.Sh HISTORY
.Nm
was first written on March 22nd 2015 as its author\(cqs first attempt at shell-scripting.
The
.Fl h
switch was added on June 10th, and a basic manpage was written on November 3rd.
.
.Pp
The
.Nm
utility was removed on March 18th 2018 in an effort to move away from macOS in favour of
.Ox .
It was restored in January 2019 after continued use of macOS became necessary.
Its manpage was rewritten to use
.Xr mdoc 7
instead of the original
.Xr man 7
macros.
.
.Pp
.ad l
On August 3rd 2024,
.Nm Ap s
default behaviour was changed to only target files whose full
.Xr basename 3
equals
.Dq .DS_Store ,
rather than targeting anything whose filename ended in that extension.
The former behaviour can be opted-into by passing the
.Fl p
switch.
.
.Sh AUTHORS
.An -nosplit
Copyright \(co 2015-2024
.An John Gardner Aq Mt gardnerjohng@gmail.com .
.Pp
Freely released under the
.Lk http://opensource.org/licenses/ISC "ISC license" .
.
.Sh CAVEATS
The
.Nm
utility is intended for use on Apple macOS.
Its usefulness on other systems is limited to purging shared network drives and portable media,
which are prone to pollution when written to from macOS.
.
.Sh BUGS
Incorrect feedback is reported when attempting to set modification times of read-only folders.
.
.Pp
The invocation
.Ql Nm Fl -home
ignores any other options that might be present, such as
.Fl p .
